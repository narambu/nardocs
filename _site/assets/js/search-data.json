{"0": {
    "doc": "apex.json",
    "title": "apex.json",
    "content": "The apex.json file points your root (apex) domain — e.g., yourdomain.com without any prefix — to a specific site. Location: {vertical}/nnet/apex.json . ",
    "url": "/nar/workspace/apex-json.html",
    
    "relUrl": "/nar/workspace/apex-json.html"
  },"1": {
    "doc": "apex.json",
    "title": "Example",
    "content": "To serve a specific site at the root domain: . { \"site\": \"prod\", \"awsRegion\": \"us-east-1\" } . To disable apex domain routing: . {} . ",
    "url": "/nar/workspace/apex-json.html#example",
    
    "relUrl": "/nar/workspace/apex-json.html#example"
  },"2": {
    "doc": "apex.json",
    "title": "Fields",
    "content": "| Field | Description | . | site | The site name to serve at the root domain (e.g., prod, dev). | . | awsRegion | The AWS region of that site (e.g., us-east-1). | . ",
    "url": "/nar/workspace/apex-json.html#fields",
    
    "relUrl": "/nar/workspace/apex-json.html#fields"
  },"3": {
    "doc": "apex.json",
    "title": "How It Works",
    "content": "When configured, Nar adds yourdomain.com as an alias on the CloudFront distribution for the specified site. Visitors to yourdomain.com see the same content as {region}.{site}.{vertical}.yourdomain.com. ",
    "url": "/nar/workspace/apex-json.html#how-it-works",
    
    "relUrl": "/nar/workspace/apex-json.html#how-it-works"
  },"4": {
    "doc": "apex.json",
    "title": "Prerequisites",
    "content": ". | domain.json must be configured first — apex routing requires a custom domain. | The domain’s hosted zone must exist in Route 53. | . ",
    "url": "/nar/workspace/apex-json.html#prerequisites",
    
    "relUrl": "/nar/workspace/apex-json.html#prerequisites"
  },"5": {
    "doc": "App Layer",
    "title": "App Layer",
    "content": "The App Layer provisions the composites that run your application and provides actions to deploy your code. ",
    "url": "/nar/nar-actions/app-layer.html",
    
    "relUrl": "/nar/nar-actions/app-layer.html"
  },"6": {
    "doc": "App Layer",
    "title": "Setup",
    "content": "Clicking Setup provisions all composite resources for the selected site. This includes the backend service infrastructure, frontend CDN, build pipeline, and (optionally) custom domain records. See Composites for the full list of resources created. You typically run Setup once per site. After that, use Deploy UI and Deploy Service for updates. ",
    "url": "/nar/nar-actions/app-layer.html#setup",
    
    "relUrl": "/nar/nar-actions/app-layer.html#setup"
  },"7": {
    "doc": "App Layer",
    "title": "Deploy UI",
    "content": "Publishes your frontend to the CDN. When you click Deploy UI, Nar builds your Vite project, uploads the output, and invalidates the CDN cache so users see the latest version. ",
    "url": "/nar/nar-actions/app-layer.html#deploy-ui",
    
    "relUrl": "/nar/nar-actions/app-layer.html#deploy-ui"
  },"8": {
    "doc": "App Layer",
    "title": "Deploy Service",
    "content": "Updates a specific backend service. | Select the service (e.g., Auth, Subscription and Billing) from the dropdown. | Click Deploy Service. | . Nar packages the service code along with shared libraries, builds a container image, and deploys the updated function. ",
    "url": "/nar/nar-actions/app-layer.html#deploy-service",
    
    "relUrl": "/nar/nar-actions/app-layer.html#deploy-service"
  },"9": {
    "doc": "Auth Service",
    "title": "Auth Service",
    "content": "The authentication logic for this vertical is provided by the shared Auth Service. View Auth Service Guide . ",
    "url": "/verticals/ral/auth.html",
    
    "relUrl": "/verticals/ral/auth.html"
  },"10": {
    "doc": "Auth Service",
    "title": "Auth Service",
    "content": "The auth service is a Python Lambda that handles Google OAuth authentication. The same source code is duplicated to all verticals provided by Nar. ",
    "url": "/verticals/common/auth.html",
    
    "relUrl": "/verticals/common/auth.html"
  },"11": {
    "doc": "Auth Service",
    "title": "What It Does",
    "content": ". | OAuth login flow with Google | Session management via JWT tokens | Session validation for authenticated API requests | Logout | . ",
    "url": "/verticals/common/auth.html#what-it-does",
    
    "relUrl": "/verticals/common/auth.html#what-it-does"
  },"12": {
    "doc": "Auth Service",
    "title": "API Endpoints",
    "content": "| Method | Path | Description | . | GET | /oauth/login | Initiate Google OAuth flow (redirects to Google) | . | GET | /oauth/loggedin | OAuth callback — exchanges code for JWT, sets session cookie | . | GET | /oauth/nn/session | Get current session (requires auth) — returns username and token | . | POST | /oauth/logout | Clear session cookie | . | GET | /test | Health check | . | GET | /version | Service version | . ",
    "url": "/verticals/common/auth.html#api-endpoints",
    
    "relUrl": "/verticals/common/auth.html#api-endpoints"
  },"13": {
    "doc": "Auth Service",
    "title": "Project Structure",
    "content": "Location: {vertical}/auth/ . auth/src/ ├── lambda_handler.py # Entry point + routing └── lfn/ ├── routes_impl.py # OAuth route handlers └── serviceenv.py # Environment variable getters . ",
    "url": "/verticals/common/auth.html#project-structure",
    
    "relUrl": "/verticals/common/auth.html#project-structure"
  },"14": {
    "doc": "Auth Service",
    "title": "Setup",
    "content": "1. Get Google OAuth Credentials . | Go to the Google Cloud Console. | Create an OAuth 2.0 Client ID (type: Web application). | Copy your Client ID and Client Secret. | . 2. Add Credentials to Your Config . Add the credentials to the service environment config. The exact path depends on your vertical’s code.json — specifically the services.configDir.location field. Typically: . {workspace}/{vertical}/services_config/nn_env.json . { \"GOOGLE_CLIENT_ID\": \"your-client-id.apps.googleusercontent.com\", \"GOOGLE_CLIENT_SECRET\": \"your-client-secret\" } . 3. Set Redirect URIs in Google Console . In the Google Cloud Console, add the Authorized redirect URI: . | With a custom domain: . https://auth.{region}.{site}.{vertical}.yourdomain.com/oauth/loggedin . | Without a custom domain: . https://{api-id}.execute-api.{region}.amazonaws.com/oauth/loggedin . | . After deploying the auth service for the first time, check the terminal output for the exact API Gateway URL. Append /oauth/loggedin to get the redirect URI. 4. Deploy . In Nar Actions: . | Select Auth from the Service dropdown. | Click Deploy Service. | . ",
    "url": "/verticals/common/auth.html#setup",
    
    "relUrl": "/verticals/common/auth.html#setup"
  },"15": {
    "doc": "Auth Service",
    "title": "Auth Service",
    "content": "The authentication logic for this vertical is provided by the shared Auth Service. View Auth Service Guide . ",
    "url": "/verticals/ppay/auth.html",
    
    "relUrl": "/verticals/ppay/auth.html"
  },"16": {
    "doc": "AWS Setup",
    "title": "Setting Up AWS for Nar",
    "content": "Create AWS credentials so Nar can deploy to your account. ",
    "url": "/prerequisites/aws-setup.html#setting-up-aws-for-nar",
    
    "relUrl": "/prerequisites/aws-setup.html#setting-up-aws-for-nar"
  },"17": {
    "doc": "AWS Setup",
    "title": "What You’ll Need",
    "content": ". | An AWS account (create one here if you don’t have one) | . ",
    "url": "/prerequisites/aws-setup.html#what-youll-need",
    
    "relUrl": "/prerequisites/aws-setup.html#what-youll-need"
  },"18": {
    "doc": "AWS Setup",
    "title": "Step 1: Create a User for Nar",
    "content": ". | Sign in to AWS Console | Search for IAM and open it | Click Users → Create user | Username: nar-deployer | Click Next | Select Attach policies directly | Don’t select anything yet — click Next | Click Create user | . ",
    "url": "/prerequisites/aws-setup.html#step-1-create-a-user-for-nar",
    
    "relUrl": "/prerequisites/aws-setup.html#step-1-create-a-user-for-nar"
  },"19": {
    "doc": "AWS Setup",
    "title": "Step 2: Give the User Permissions",
    "content": ". | Click on your new user nar-deployer | Go to the Permissions tab | Click Add permissions → Create inline policy | Switch to the JSON tab and paste: | . { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Sid\": \"NarIamBootstrap\", \"Effect\": \"Allow\", \"Action\": [ \"iam:AttachRolePolicy\", \"iam:CreatePolicy\", \"iam:CreateRole\", \"iam:DeleteAccessKey\", \"iam:DeletePolicy\", \"iam:DeleteRole\", \"iam:DeleteRolePolicy\", \"iam:DeleteUser\", \"iam:DeleteUserPolicy\", \"iam:DetachRolePolicy\", \"iam:DetachUserPolicy\", \"iam:GetPolicy\", \"iam:GetRole\", \"iam:ListAccessKeys\", \"iam:ListAttachedRolePolicies\", \"iam:ListAttachedUserPolicies\", \"iam:ListPolicies\", \"iam:ListRolePolicies\", \"iam:ListRoles\", \"iam:ListUserPolicies\", \"iam:ListUsers\", \"iam:PutRolePolicy\", \"iam:PutUserPolicy\", \"iam:UpdateAssumeRolePolicy\" ], \"Resource\": \"*\" } ] } . | Click Next | Name it: nar_iam_bootstrap | Click Create policy | . ",
    "url": "/prerequisites/aws-setup.html#step-2-give-the-user-permissions",
    
    "relUrl": "/prerequisites/aws-setup.html#step-2-give-the-user-permissions"
  },"20": {
    "doc": "AWS Setup",
    "title": "Step 3: Get Your Access Keys",
    "content": ". | On the nar-deployer user page, click Security credentials | Scroll to Access keys → Create access key | Select Command Line Interface (CLI) | Check the confirmation box, click Next, then Create access key | . Copy both the Access key ID and Secret access key now. The secret won’t be shown again. ",
    "url": "/prerequisites/aws-setup.html#step-3-get-your-access-keys",
    
    "relUrl": "/prerequisites/aws-setup.html#step-3-get-your-access-keys"
  },"21": {
    "doc": "AWS Setup",
    "title": "Step 4: Save Keys on Your Machine",
    "content": "Open Terminal: . mkdir -p ~/.aws . Create ~/.aws/config: . cat &gt; ~/.aws/config &lt;&lt; 'EOF' [default] region = us-east-1 EOF . Create ~/.aws/credentials (replace with your keys): . cat &gt; ~/.aws/credentials &lt;&lt; 'EOF' [default] aws_access_key_id = PASTE_YOUR_ACCESS_KEY_HERE aws_secret_access_key = PASTE_YOUR_SECRET_KEY_HERE EOF . ",
    "url": "/prerequisites/aws-setup.html#step-4-save-keys-on-your-machine",
    
    "relUrl": "/prerequisites/aws-setup.html#step-4-save-keys-on-your-machine"
  },"22": {
    "doc": "AWS Setup",
    "title": "Done",
    "content": "Nar uses the default AWS profile by default. You’re ready to run Init. ",
    "url": "/prerequisites/aws-setup.html#done",
    
    "relUrl": "/prerequisites/aws-setup.html#done"
  },"23": {
    "doc": "AWS Setup",
    "title": "Using a Different Profile",
    "content": "If you already use AWS and want a separate profile for Nar: . 1. Add to ~/.aws/config: . [profile myprofile] region = us-east-1 . 2. Add to ~/.aws/credentials: . [myprofile] aws_access_key_id = PASTE_YOUR_ACCESS_KEY_HERE aws_secret_access_key = PASTE_YOUR_SECRET_KEY_HERE . 3. Set the profile in your vertical’s nnet/awsprofile.json: . { \"iamAwsProfile\": \"myprofile\" } . ",
    "url": "/prerequisites/aws-setup.html#using-a-different-profile",
    
    "relUrl": "/prerequisites/aws-setup.html#using-a-different-profile"
  },"24": {
    "doc": "AWS Setup",
    "title": "Troubleshooting",
    "content": "| Problem | Solution | . | “Unable to locate credentials” | Check that ~/.aws/credentials exists and has the right format. | . | “AccessDenied” when running Init | Verify you added the nar_iam_bootstrap policy in Step 2. | . | “InvalidClientTokenId” | The access key ID is wrong — create new access keys in AWS. | . ",
    "url": "/prerequisites/aws-setup.html#troubleshooting",
    
    "relUrl": "/prerequisites/aws-setup.html#troubleshooting"
  },"25": {
    "doc": "AWS Setup",
    "title": "AWS Setup",
    "content": " ",
    "url": "/prerequisites/aws-setup.html",
    
    "relUrl": "/prerequisites/aws-setup.html"
  },"26": {
    "doc": "AWS",
    "title": "AWS Composites",
    "content": "Each composite below provisions and manages a specific set of AWS resources. | Composite | What it deploys | . | Lambda + API Gateway | Backend services as Lambda functions behind API Gateway. | . | CloudFront + S3 | Frontend as a Vite build to S3 behind CloudFront. | . ",
    "url": "/nar/composites/aws.html#aws-composites",
    
    "relUrl": "/nar/composites/aws.html#aws-composites"
  },"27": {
    "doc": "AWS",
    "title": "AWS",
    "content": " ",
    "url": "/nar/composites/aws.html",
    
    "relUrl": "/nar/composites/aws.html"
  },"28": {
    "doc": "AWS",
    "title": "Composites",
    "content": " ",
    "url": "/nar/faq/aws.html#composites",
    
    "relUrl": "/nar/faq/aws.html#composites"
  },"29": {
    "doc": "AWS",
    "title": "Can I use my own Dockerfile for services?",
    "content": "Yes. Nar deploys serverless services as container images. The default Dockerfile targets Python 3.13, but you can bring your own. How to Use a Custom Dockerfile . Add a dockerfile field to your service entry in code.json: . { \"name\": \"my_service\", \"location\": \"orig/my_service\", \"dockerfile\": \"/your/location/for/Dockerfile\" } . Why Bring Your Own Dockerfile . | Different language — Use Node.js, Go, Rust, or any language that supports serverless container runtimes. The deploy pipeline is language-agnostic. | Different Python version — Pin to a specific Python version instead of the default 3.13. | System dependencies — Install packages like ffmpeg, imagemagick, or native libraries your code depends on. | Binary compilation — Build native extensions or compiled binaries that require a specific build environment. | Custom project layout — If your service doesn’t follow the default src/ and scripts/requirements.txt conventions. | . What Your Custom Dockerfile Receives . When Nar deploys a service, it packages your source code, shared libraries, and generated files and runs docker build with your Dockerfile. The build context looks like this: . build context/ ├── auth/ ← service source (name from code.json) │ ├── src/ │ └── scripts/ ├── common/ ← shared library (if any) │ ├── src/ │ └── scripts/ ├── nar_env.sh ← environment variables as shell exports └── lambda_dockerfile ← the Dockerfile being used . Nar also passes two build arguments so your Dockerfile can locate the right directories: . | API_NAME — the service name (e.g., auth) | SHARED_DIRS — comma-separated shared library names (e.g., common) | . Environment Variables . Nar generates nar_env.sh containing all environment variables as shell exports (bucket names, service URLs, nn_env.json values). Your Dockerfile should source this file in its entrypoint: . ARG API_NAME COPY . /tmp/build/ RUN cp -r /tmp/build/${API_NAME}/src/. /var/task/ RUN cp /tmp/build/${API_NAME}/src/nar_env.sh /var/task/ ENTRYPOINT [\"/bin/bash\", \"-c\", \"source /var/task/nar_env.sh &amp;&amp; exec /var/task/bootstrap\"] . See the default Dockerfile for a complete working example. ",
    "url": "/nar/faq/aws.html#can-i-use-my-own-dockerfile-for-services",
    
    "relUrl": "/nar/faq/aws.html#can-i-use-my-own-dockerfile-for-services"
  },"30": {
    "doc": "AWS",
    "title": "AWS",
    "content": " ",
    "url": "/nar/faq/aws.html",
    
    "relUrl": "/nar/faq/aws.html"
  },"31": {
    "doc": "awsprofile.json",
    "title": "awsprofile.json",
    "content": "The awsprofile.json file tells Nar which AWS CLI profile to use for deployments. Location: {vertical}/nnet/awsprofile.json . ",
    "url": "/nar/workspace/awsprofile-json.html",
    
    "relUrl": "/nar/workspace/awsprofile-json.html"
  },"32": {
    "doc": "awsprofile.json",
    "title": "Example",
    "content": "To use a specific profile: . { \"iamAwsProfile\": \"myprofile\" } . To use the default profile: . { \"iamAwsProfile\": \"default\" } . ",
    "url": "/nar/workspace/awsprofile-json.html#example",
    
    "relUrl": "/nar/workspace/awsprofile-json.html#example"
  },"33": {
    "doc": "awsprofile.json",
    "title": "Fields",
    "content": "| Field | Description | . | iamAwsProfile | The name of the AWS CLI profile from ~/.aws/credentials that Nar should use. | . ",
    "url": "/nar/workspace/awsprofile-json.html#fields",
    
    "relUrl": "/nar/workspace/awsprofile-json.html#fields"
  },"34": {
    "doc": "awsprofile.json",
    "title": "When to Use",
    "content": "If you have multiple AWS accounts or profiles configured in ~/.aws/credentials and want Nar to use a specific one instead of default, set it here. See AWS Setup for how to configure multiple AWS profiles. ",
    "url": "/nar/workspace/awsprofile-json.html#when-to-use",
    
    "relUrl": "/nar/workspace/awsprofile-json.html#when-to-use"
  },"35": {
    "doc": "byv/buckets.json",
    "title": "byv/buckets.json",
    "content": "The buckets.json file defines additional S3 buckets beyond the built-in ones that Nar creates automatically. Location: {vertical}/nnet/byv/buckets.json . ",
    "url": "/nar/workspace/buckets-json.html",
    
    "relUrl": "/nar/workspace/buckets-json.html"
  },"36": {
    "doc": "byv/buckets.json",
    "title": "Example",
    "content": "[ { \"name\": \"uploads\", \"versioning\": true, \"force_destroy\": false }, { \"name\": \"temp\", \"versioning\": false, \"ttl_days\": 30, \"force_destroy\": true } ] . To not create any additional buckets: . [] . ",
    "url": "/nar/workspace/buckets-json.html#example",
    
    "relUrl": "/nar/workspace/buckets-json.html#example"
  },"37": {
    "doc": "byv/buckets.json",
    "title": "Fields",
    "content": "Each entry in the array is a bucket definition: . | Field | Description | Required | . | name | Bucket name prefix. The full bucket name includes the site, vertical, region, and account ID. | Yes | . | versioning | Enable S3 versioning on this bucket. | No (default: false) | . | ttl_days | Lifecycle rule — automatically delete objects after this many days. | No | . | force_destroy | Allow Nar to destroy this bucket even if it contains objects. | No (default: false) | . ",
    "url": "/nar/workspace/buckets-json.html#fields",
    
    "relUrl": "/nar/workspace/buckets-json.html#fields"
  },"38": {
    "doc": "byv/buckets.json",
    "title": "Built-in Buckets",
    "content": "Nar automatically creates these buckets without any configuration: . | Prefix | Purpose | Layer | . | perm | Protected persistent data (versioning enabled) | Data | . | uico | UI assets served by CloudFront | App | . | arti | Build artifacts (7-day TTL) | App | . | scra | Scratch/temporary files (7-day TTL) | App | . Use byv/buckets.json when you need buckets beyond these defaults. ",
    "url": "/nar/workspace/buckets-json.html#built-in-buckets",
    
    "relUrl": "/nar/workspace/buckets-json.html#built-in-buckets"
  },"39": {
    "doc": "CloudFront + S3",
    "title": "CloudFront + S3",
    "content": "Your React + Vite frontend gets built locally and deployed to S3 behind a CloudFront CDN. ",
    "url": "/nar/composites/aws/cloudfront-s3.html",
    
    "relUrl": "/nar/composites/aws/cloudfront-s3.html"
  },"40": {
    "doc": "CloudFront + S3",
    "title": "AWS Architecture",
    "content": "Frontend assets are built locally and served globally through CloudFront CDN backed by an S3 origin bucket. User Browser │ ▼ CloudFront CDN (Edge Locations) │ ▼ S3 Bucket (Origin, via OAC) . How it works: . | When you click Deploy UI, Nar builds your React + Vite project and uploads the output to an S3 bucket. | CloudFront distributes the assets to edge locations worldwide for fast delivery. | Origin Access Control (OAC) ensures the S3 bucket is only accessible through CloudFront, not directly. | Cache invalidation runs automatically after each deployment so users see the latest version. | If you configure a custom domain, your site is accessible at: . {site}.yourdomain.com . | . AWS resources created: . S3 bucket, CloudFront distribution, Origin Access Control, and optionally Route 53 records + ACM certificates for custom domains. ",
    "url": "/nar/composites/aws/cloudfront-s3.html#aws-architecture",
    
    "relUrl": "/nar/composites/aws/cloudfront-s3.html#aws-architecture"
  },"41": {
    "doc": "CloudFront + S3",
    "title": "Deployment Process",
    "content": "When you click Deploy UI (or run the CLI equivalent), Nar: . | Generates .env.production and .env.development files in the project root | Runs npm install | Runs npm run build | Clears the UI S3 bucket | Uploads the build output to S3 | Invalidates the CloudFront distribution so users see the latest version | . ",
    "url": "/nar/composites/aws/cloudfront-s3.html#deployment-process",
    
    "relUrl": "/nar/composites/aws/cloudfront-s3.html#deployment-process"
  },"42": {
    "doc": "CloudFront + S3",
    "title": "Environment Variables",
    "content": "See UI Environment Variables. ",
    "url": "/nar/composites/aws/cloudfront-s3.html#environment-variables",
    
    "relUrl": "/nar/composites/aws/cloudfront-s3.html#environment-variables"
  },"43": {
    "doc": "code.json",
    "title": "code.json",
    "content": "code.json is the high-level configuration that connects your source code to composites. It tells Nar where your code lives and which composite deploys it. Location: {vertical}/nnet/code.json . ",
    "url": "/nar/workspace/code-json.html",
    
    "relUrl": "/nar/workspace/code-json.html"
  },"44": {
    "doc": "code.json",
    "title": "Structure",
    "content": "{ \"services\": { \"lambda\": [...], \"...\": [...] }, \"ui\": { \"vite\": {...}, \"...\": {...} } } . Each key under services and ui maps to a deployment type: . | Key | Description | . | services.lambda | Serverless backend functions | . | ui.vite | Vite-built frontend application | . ",
    "url": "/nar/workspace/code-json.html#structure",
    
    "relUrl": "/nar/workspace/code-json.html#structure"
  },"45": {
    "doc": "code.json",
    "title": "Example",
    "content": "{ \"services\": { \"lambda\": [ { \"name\": \"auth\", \"location\": \"orig/auth\" }, { \"name\": \"sbcs\", \"location\": \"orig/sbcs\" } ], \"sharedLibs\": [ { \"name\": \"common\", \"location\": \"orig/common\" } ], \"configDir\": { \"name\": \"services_config\", \"location\": \"orig/services_config\" } }, \"ui\": { \"vite\": { \"name\": \"ui\", \"location\": \"orig/ui\" }, \"common\": { \"name\": \"uicommon\", \"location\": \"orig/uicommon\" }, \"configDir\": { \"name\": \"ui_config\", \"location\": \"orig/ui_config\" } } } . ",
    "url": "/nar/workspace/code-json.html#example",
    
    "relUrl": "/nar/workspace/code-json.html#example"
  },"46": {
    "doc": "code.json",
    "title": "Custom Paths",
    "content": "All paths are relative to the vertical folder. To deploy code from an existing repo instead of the bundled vertical source, change any location to point there. For example, to use your own UI project: . \"vite\": { \"name\": \"ui\", \"location\": \"/Users/you/repos/my-app/frontend\" } . After updating paths, run Fix Paths to apply the changes. ",
    "url": "/nar/workspace/code-json.html#custom-paths",
    
    "relUrl": "/nar/workspace/code-json.html#custom-paths"
  },"47": {
    "doc": "Common Sources",
    "title": "Common Sources",
    "content": "The same source code for these components is duplicated to all verticals provided by Nar. | Auth Service — Google OAuth authentication backend, deployed as a Lambda service. | UI Packages — Shared React components and utilities imported by vertical UIs. | . ",
    "url": "/verticals/common.html",
    
    "relUrl": "/verticals/common.html"
  },"48": {
    "doc": "Composites",
    "title": "Composites",
    "content": "Each application component maps to a composite — a set of cloud resources that Nar provisions and manages together. Your code.json maps your source code to these composites. Nar currently supports AWS Composites. ",
    "url": "/nar/composites.html",
    
    "relUrl": "/nar/composites.html"
  },"49": {
    "doc": "Configuration (nnet/)",
    "title": "Configuration (nnet/)",
    "content": "Each vertical has an nnet/ directory that contains all user-editable configuration. This is how you tell Nar what to deploy, where to deploy it, and under what domain. ral/ └── nnet/ ├── code.json # What services and UI to deploy ├── domain.json # Custom domain name ├── apex.json # Root (apex) domain settings ├── awsprofile.json # Which AWS CLI profile to use ├── cors.json # Extra CORS origins per bucket (optional) ├── byv/ │ └── buckets.json # Additional S3 buckets to create └── site/ └── dev_us-east-1.json # Site definition (one file per site+region) . | File | Purpose | . | code.json | Defines your Lambda services, shared libraries, UI location, and config directories. | . | domain.json | Sets a custom domain for your deployment (requires a Route 53 hosted zone). | . | apex.json | Ties your root domain (e.g., yourdomain.com) to a specific site. | . | awsprofile.json | Specifies which AWS CLI profile Nar should use (defaults to default). | . | cors.json | Extra allowed origins for CORS on your S3 buckets (optional). | . | byv/buckets.json | Defines additional S3 buckets beyond the built-in ones. | . | site/*.json | Each file represents a deployable site+region combination. Filename format: {site}_{region}.json. | . Nar preserves the nnet/ directory when you re-import or update a vertical — your configuration is never overwritten. ",
    "url": "/nar/workspace/config.html",
    
    "relUrl": "/nar/workspace/config.html"
  },"50": {
    "doc": "cors.json",
    "title": "cors.json",
    "content": "The cors.json file lets you add extra allowed origins for Cross-Origin Resource Sharing (CORS) on your S3 buckets. This is optional — Nar automatically configures CORS with your deployment URLs and localhost origins when you use the CORS tool. Location: {vertical}/nnet/cors.json . ",
    "url": "/nar/workspace/cors-json.html",
    
    "relUrl": "/nar/workspace/cors-json.html"
  },"51": {
    "doc": "cors.json",
    "title": "Example",
    "content": "{ \"buckets\": { \"perm\": [ \"https://myapp.example.com\", \"https://staging.example.com\" ], \"uploads\": [ \"https://myapp.example.com\" ] } } . To not add any extra origins (or if you don’t need custom CORS): . {} . Or simply omit the file — it’s entirely optional. ",
    "url": "/nar/workspace/cors-json.html#example",
    
    "relUrl": "/nar/workspace/cors-json.html#example"
  },"52": {
    "doc": "cors.json",
    "title": "Fields",
    "content": "| Field | Description | Required | . | buckets | An object where each key is a bucket prefix and each value is a list of allowed origin URLs. | No | . Each key under buckets is a bucket prefix (e.g., perm, uico, arti, scra, or any custom bucket defined in byv/buckets.json). The value is an array of origin URLs that should be allowed to make cross-origin requests to that bucket. ",
    "url": "/nar/workspace/cors-json.html#fields",
    
    "relUrl": "/nar/workspace/cors-json.html#fields"
  },"53": {
    "doc": "cors.json",
    "title": "How It Works",
    "content": "When you click Enable CORS in the Tools panel for a bucket, Nar merges three sets of origins: . | Deployment origins — Your CloudFront and custom domain URLs (detected automatically). | Localhost origins — http://localhost:5173, http://localhost:3000, and their 127.0.0.1 equivalents (for local development). | Extra origins from cors.json — Any additional origins you specify here for that bucket prefix. | . All three are combined and applied as the CORS policy on the S3 bucket. ",
    "url": "/nar/workspace/cors-json.html#how-it-works",
    
    "relUrl": "/nar/workspace/cors-json.html#how-it-works"
  },"54": {
    "doc": "Data Layer",
    "title": "Data Layer",
    "content": "The Data Layer provisions the infrastructure your application uses for persistent storage. This is where any resources that hold data live — separate from the App Layer so your data is safe even if you tear down and rebuild your application. ",
    "url": "/nar/nar-actions/data-layer.html",
    
    "relUrl": "/nar/nar-actions/data-layer.html"
  },"55": {
    "doc": "Data Layer",
    "title": "Setup",
    "content": "Clicking Setup creates the Data Layer for the selected site. Resources in this layer are protected — buckets have versioning enabled and force-destroy disabled, meaning they survive App Layer deletion and cannot be accidentally removed with data still inside. You typically run this once per site. ",
    "url": "/nar/nar-actions/data-layer.html#setup",
    
    "relUrl": "/nar/nar-actions/data-layer.html#setup"
  },"56": {
    "doc": "Data Layer",
    "title": "What’s Created",
    "content": ". | Built-in buckets that Nar provides automatically (e.g., perm for persistent data). | Any additional buckets you define in byv/buckets.json. | . ",
    "url": "/nar/nar-actions/data-layer.html#whats-created",
    
    "relUrl": "/nar/nar-actions/data-layer.html#whats-created"
  },"57": {
    "doc": "Data Layer",
    "title": "Relationship to the App Layer",
    "content": "The App Layer references the Data Layer’s state to discover bucket names and pass them as environment variables to your services. This means you must set up the Data Layer before the App Layer. ",
    "url": "/nar/nar-actions/data-layer.html#relationship-to-the-app-layer",
    
    "relUrl": "/nar/nar-actions/data-layer.html#relationship-to-the-app-layer"
  },"58": {
    "doc": "Default Dockerfile",
    "title": "Default Dockerfile",
    "content": "Nar’s default Dockerfile builds a Python 3.13 Lambda container image. It expects the following project layout for each service and shared library: . {service}/ ├── src/ # Python source code │ └── lambda_handler.py # Lambda entry point └── scripts/ └── requirements.txt # pip dependencies . Shared libraries follow the same convention: . {shared_lib}/ ├── src/ # Reusable Python modules └── scripts/ └── requirements.txt # pip dependencies . During the build, Nar: . | Installs requirements.txt from each shared library | Installs requirements.txt from the service | Copies all src/ directories to the Lambda task root (/var/task/) | Sets the entrypoint with Nar-generated environment variables | . To use a different Python version, add system packages, or use a non-Python language, provide a custom Dockerfile. View the default Dockerfile # syntax=docker/dockerfile:1.6 FROM public.ecr.aws/docker/library/python:3.13-slim-bookworm ENV PYTHONPATH=/var/task ARG API_NAME ARG SHARED_DIRS ENV PIP_DISABLE_PIP_VERSION_CHECK=1 \\ PYTHONDONTWRITEBYTECODE=1 \\ HOME=/tmp RUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\ ca-certificates \\ fontconfig \\ fonts-dejavu \\ fonts-liberation \\ fonts-noto-cjk \\ fonts-noto-color-emoji \\ &amp;&amp; rm -rf /var/lib/apt/lists/* \\ &amp;&amp; fc-cache -f RUN pip install --no-cache-dir awslambdaric==3.1.1 # Copy everything to temp build directory COPY . /tmp/build/ # Install requirements from each shared directory (if SHARED_DIRS is provided) RUN if [ -n \"$SHARED_DIRS\" ]; then \\ for dir in $(echo \"$SHARED_DIRS\" | tr ',' ' '); do \\ if [ -f \"/tmp/build/${dir}/scripts/requirements.txt\" ] &amp;&amp; [ -s \"/tmp/build/${dir}/scripts/requirements.txt\" ]; then \\ pip install --no-cache-dir -r \"/tmp/build/${dir}/scripts/requirements.txt\"; \\ fi; \\ done; \\ fi # Install service-specific requirements RUN if [ -f \"/tmp/build/${API_NAME}/scripts/requirements.txt\" ] &amp;&amp; [ -s \"/tmp/build/${API_NAME}/scripts/requirements.txt\" ]; then \\ pip install --no-cache-dir -r \"/tmp/build/${API_NAME}/scripts/requirements.txt\"; \\ fi # Copy shared directories to /var/task RUN if [ -n \"$SHARED_DIRS\" ]; then \\ for dir in $(echo \"$SHARED_DIRS\" | tr ',' ' '); do \\ if [ -d \"/tmp/build/${dir}/src\" ]; then \\ cp -r /tmp/build/${dir}/src/. /var/task/; \\ fi; \\ done; \\ fi # Copy service source RUN cp -r /tmp/build/${API_NAME}/src/. /var/task/ # Cleanup RUN rm -rf /tmp/build WORKDIR /var/task ENTRYPOINT [\"/var/task/start_lambda.sh\"] . ",
    "url": "/nar/composites/aws/lambda-api-gateway/default-dockerfile.html",
    
    "relUrl": "/nar/composites/aws/lambda-api-gateway/default-dockerfile.html"
  },"59": {
    "doc": "Destructive Actions",
    "title": "Destructive Actions",
    "content": "These operations permanently delete cloud resources and data. They cannot be undone. ",
    "url": "/nar/nar-actions/destructive-actions.html",
    
    "relUrl": "/nar/nar-actions/destructive-actions.html"
  },"60": {
    "doc": "Destructive Actions",
    "title": "Empty Bucket",
    "content": "Your cloud provider prevents deleting a bucket that still contains objects. If a layer deletion fails because of non-empty buckets, select the bucket and click Empty to delete all objects inside it. ",
    "url": "/nar/nar-actions/destructive-actions.html#empty-bucket",
    
    "relUrl": "/nar/nar-actions/destructive-actions.html#empty-bucket"
  },"61": {
    "doc": "Destructive Actions",
    "title": "Delete App Layer",
    "content": "Removes the composite resources for the selected site. Your Data Layer (storage buckets and their contents) is not affected. ",
    "url": "/nar/nar-actions/destructive-actions.html#delete-app-layer",
    
    "relUrl": "/nar/nar-actions/destructive-actions.html#delete-app-layer"
  },"62": {
    "doc": "Destructive Actions",
    "title": "Delete Data Layer",
    "content": "Removes the storage buckets and their contents for the selected site. All data in these buckets will be permanently deleted. Make sure you have backups if needed. ",
    "url": "/nar/nar-actions/destructive-actions.html#delete-data-layer",
    
    "relUrl": "/nar/nar-actions/destructive-actions.html#delete-data-layer"
  },"63": {
    "doc": "Destructive Actions",
    "title": "Nuke",
    "content": "Force-deletes all resources for a site when standard deletion fails — for example, if the state file is corrupt or missing. Nuke scans for resources tagged with this site and destroys them directly, bypassing the state file. Use this as a last resort. ",
    "url": "/nar/nar-actions/destructive-actions.html#nuke",
    
    "relUrl": "/nar/nar-actions/destructive-actions.html#nuke"
  },"64": {
    "doc": "domain.json",
    "title": "domain.json",
    "content": "The domain.json file connects your deployment to a custom domain name. Location: {vertical}/nnet/domain.json . ",
    "url": "/nar/workspace/domains-json.html",
    
    "relUrl": "/nar/workspace/domains-json.html"
  },"65": {
    "doc": "domain.json",
    "title": "Example",
    "content": "To use a custom domain: . { \"name\": \"yourdomain.com\" } . To deploy without a custom domain (uses default AWS-generated URLs): . {} . ",
    "url": "/nar/workspace/domains-json.html#example",
    
    "relUrl": "/nar/workspace/domains-json.html#example"
  },"66": {
    "doc": "domain.json",
    "title": "What Happens When You Set a Domain",
    "content": "Nar creates Route 53 DNS records and ACM certificates to map your deployment to the domain. The URL patterns generated are: . | Resource | URL Pattern | . | UI (CloudFront) | {region}.{site}.{vertical}.yourdomain.com | . | Service (API Gateway) | {service}.{region}.{site}.{vertical}.yourdomain.com | . For example, with domain example.com, vertical ral, site dev, region us-east-1: . | UI: us-east-1.dev.ral.example.com | Auth service: auth.us-east-1.dev.ral.example.com | . ",
    "url": "/nar/workspace/domains-json.html#what-happens-when-you-set-a-domain",
    
    "relUrl": "/nar/workspace/domains-json.html#what-happens-when-you-set-a-domain"
  },"67": {
    "doc": "domain.json",
    "title": "Prerequisites",
    "content": ". | The domain must have a hosted zone in Route 53. If you registered your domain elsewhere, create a hosted zone in Route 53 and update your domain’s nameservers to point to it. | DNS propagation and certificate validation can add a few minutes to the first deployment with a new domain. | . ",
    "url": "/nar/workspace/domains-json.html#prerequisites",
    
    "relUrl": "/nar/workspace/domains-json.html#prerequisites"
  },"68": {
    "doc": "domain.json",
    "title": "Without a Custom Domain",
    "content": "If domain.json is empty ({}), your services and UI are accessible through default AWS-generated URLs: . | UI: A CloudFront distribution URL (e.g., d1234abcdef.cloudfront.net) | Services: API Gateway URLs (e.g., abc123.execute-api.us-east-1.amazonaws.com) | . ",
    "url": "/nar/workspace/domains-json.html#without-a-custom-domain",
    
    "relUrl": "/nar/workspace/domains-json.html#without-a-custom-domain"
  },"69": {
    "doc": "Environment Variables",
    "title": "Service Environment Variables",
    "content": "Nar provides environment variables to every service at runtime. Variables come from two sources: infrastructure that Nar discovers automatically, and your nn_env.json configuration files. All JSON values are converted to strings: arrays become comma-separated, booleans become \"true\" or \"false\", and nulls become empty strings. ",
    "url": "/nar/workspace/code-json/services-lambda/environment-variables.html#service-environment-variables",
    
    "relUrl": "/nar/workspace/code-json/services-lambda/environment-variables.html#service-environment-variables"
  },"70": {
    "doc": "Environment Variables",
    "title": "Variables Nar Provides",
    "content": "| Variable | Example | Description | . | SERVICE_AWS_REGION | us-east-1 | The region where this service is deployed. | . | site | dev | The site name. | . | {PREFIX}_BUCKET | perm-dev-ral-us-east-1-059279877465 | One variable per S3 bucket prefix defined in buckets.json (e.g., IMAGES_BUCKET, NOTES_BUCKET, PERM_BUCKET, SCRA_BUCKET). | . | {SERVICE}_SERVICE_URL | https://auth.us-east-1.dev.ral.narambu.com | URL of each sibling service defined in services.lambda[] (e.g., AUTH_SERVICE_URL, SBCS_SERVICE_URL). | . Any values you define in nn_env.json are also injected as environment variables. ",
    "url": "/nar/workspace/code-json/services-lambda/environment-variables.html#variables-nar-provides",
    
    "relUrl": "/nar/workspace/code-json/services-lambda/environment-variables.html#variables-nar-provides"
  },"71": {
    "doc": "Environment Variables",
    "title": "nn_env.json — Global Config",
    "content": "{vertical}/services_config/nn_env.json applies to all services. Example: . { \"JWT_ALGORITHM\": \"HS256\", \"JWT_SECRET\": \"your-secret-here\", \"GOOGLE_CLIENT_ID\": \"your-client-id.apps.googleusercontent.com\", \"GOOGLE_CLIENT_SECRET\": \"your-client-secret\" } . ",
    "url": "/nar/workspace/code-json/services-lambda/environment-variables.html#nn_envjson--global-config",
    
    "relUrl": "/nar/workspace/code-json/services-lambda/environment-variables.html#nn_envjson--global-config"
  },"72": {
    "doc": "Environment Variables",
    "title": "nn_env.json — Per-Service Config",
    "content": "Each service can have its own {vertical}/{service}/config/nn_env.json. These values override the global config for that service only. ",
    "url": "/nar/workspace/code-json/services-lambda/environment-variables.html#nn_envjson--per-service-config",
    
    "relUrl": "/nar/workspace/code-json/services-lambda/environment-variables.html#nn_envjson--per-service-config"
  },"73": {
    "doc": "Environment Variables",
    "title": "Merge Priority",
    "content": "When the same key appears in multiple sources, the highest-priority source wins: . | Priority | Source | Scope | . | 1 (highest) | {vertical}/{service}/config/nn_env.json | Per-service | . | 2 | {vertical}/services_config/nn_env.json | All services | . | 3 (lowest) | Nar-provided | Buckets, service URLs, region, site | . ",
    "url": "/nar/workspace/code-json/services-lambda/environment-variables.html#merge-priority",
    
    "relUrl": "/nar/workspace/code-json/services-lambda/environment-variables.html#merge-priority"
  },"74": {
    "doc": "Environment Variables",
    "title": "Example",
    "content": "A service deployed to site dev with the above configuration would see: . SERVICE_AWS_REGION=us-east-1 site=dev IMAGES_BUCKET=images-dev-ral-us-east-1-059279877465 PERM_BUCKET=perm-dev-ral-us-east-1-059279877465 AUTH_SERVICE_URL=https://auth.us-east-1.dev.ral.narambu.com SBCS_SERVICE_URL=https://sbcs.us-east-1.dev.ral.narambu.com JWT_ALGORITHM=HS256 JWT_SECRET=your-secret-here GOOGLE_CLIENT_ID=your-client-id.apps.googleusercontent.com GOOGLE_CLIENT_SECRET=your-client-secret . ",
    "url": "/nar/workspace/code-json/services-lambda/environment-variables.html#example",
    
    "relUrl": "/nar/workspace/code-json/services-lambda/environment-variables.html#example"
  },"75": {
    "doc": "Environment Variables",
    "title": "Environment Variables",
    "content": " ",
    "url": "/nar/workspace/code-json/services-lambda/environment-variables.html",
    
    "relUrl": "/nar/workspace/code-json/services-lambda/environment-variables.html"
  },"76": {
    "doc": "Environment Variables",
    "title": "UI Environment Variables",
    "content": "Nar generates VITE_ environment variables available to your React code at build time via import.meta.env. All JSON values are converted to strings: arrays become comma-separated, booleans become \"true\" or \"false\", and nulls become empty strings. ",
    "url": "/nar/workspace/code-json/ui-vite/environment-variables.html#ui-environment-variables",
    
    "relUrl": "/nar/workspace/code-json/ui-vite/environment-variables.html#ui-environment-variables"
  },"77": {
    "doc": "Environment Variables",
    "title": "Variables Nar Provides",
    "content": "| Variable | Example | Description | . | VITE_{SERVICE}_SERVICE_URL | https://auth.us-east-1.dev.ral.narambu.com | URL of each service defined in services.lambda[]. | . | VITE_HOME_URL | https://daw8sipu4p6qe.cloudfront.net | The CloudFront distribution domain. | . With a custom domain, VITE_{SERVICE}_SERVICE_URL values follow this pattern: . https://{service}.{region}.{site}.{vertical}.{domain} . Without a custom domain, they contain the raw API Gateway endpoint URL. Any values you define in nn_env.json are also injected, automatically prefixed with VITE_. ",
    "url": "/nar/workspace/code-json/ui-vite/environment-variables.html#variables-nar-provides",
    
    "relUrl": "/nar/workspace/code-json/ui-vite/environment-variables.html#variables-nar-provides"
  },"78": {
    "doc": "Environment Variables",
    "title": "nn_env.json — UI Config",
    "content": "{vertical}/ui_config/nn_env.json defines additional environment variables for the UI. Example: . { \"name\": \"myapp\", \"FEATURE_FLAGS\": \"dark_mode,notifications\" } . This produces: . VITE_name=myapp VITE_FEATURE_FLAGS=dark_mode,notifications . ",
    "url": "/nar/workspace/code-json/ui-vite/environment-variables.html#nn_envjson--ui-config",
    
    "relUrl": "/nar/workspace/code-json/ui-vite/environment-variables.html#nn_envjson--ui-config"
  },"79": {
    "doc": "Environment Variables",
    "title": "Merge Priority",
    "content": "| Priority | Source | Description | . | 1 (highest) | {vertical}/ui_config/nn_env.json | UI config | . | 2 (lowest) | Nar-provided | Service URLs and CloudFront domain | . ",
    "url": "/nar/workspace/code-json/ui-vite/environment-variables.html#merge-priority",
    
    "relUrl": "/nar/workspace/code-json/ui-vite/environment-variables.html#merge-priority"
  },"80": {
    "doc": "Environment Variables",
    "title": "Accessing Variables in React",
    "content": "Use import.meta.env to access any VITE_ variable: . const authUrl = import.meta.env.VITE_AUTH_SERVICE_URL; const appName = import.meta.env.VITE_name; . ",
    "url": "/nar/workspace/code-json/ui-vite/environment-variables.html#accessing-variables-in-react",
    
    "relUrl": "/nar/workspace/code-json/ui-vite/environment-variables.html#accessing-variables-in-react"
  },"81": {
    "doc": "Environment Variables",
    "title": "Environment Variables",
    "content": " ",
    "url": "/nar/workspace/code-json/ui-vite/environment-variables.html",
    
    "relUrl": "/nar/workspace/code-json/ui-vite/environment-variables.html"
  },"82": {
    "doc": "FAQ",
    "title": "Frequently Asked Questions",
    "content": "Browse by topic below. ",
    "url": "/nar/faq.html#frequently-asked-questions",
    
    "relUrl": "/nar/faq.html#frequently-asked-questions"
  },"83": {
    "doc": "FAQ",
    "title": "FAQ",
    "content": " ",
    "url": "/nar/faq.html",
    
    "relUrl": "/nar/faq.html"
  },"84": {
    "doc": "Fix Paths",
    "title": "Fix Paths",
    "content": "The location fields in code.json can point to directories inside or outside the workspace. Nar resolves these paths and creates symlinks in your workspace that point to the actual source code directories. Whenever you update a location in code.json, click Fix Paths to recreate the symlinks. ",
    "url": "/nar/nar-actions/fix-paths.html",
    
    "relUrl": "/nar/nar-actions/fix-paths.html"
  },"85": {
    "doc": "Getting Started",
    "title": "Getting Started with React Auth Lambda",
    "content": "This vertical comes bundled with Nar — no separate download needed. ",
    "url": "/verticals/ral/getting-started.html#getting-started-with-react-auth-lambda",
    
    "relUrl": "/verticals/ral/getting-started.html#getting-started-with-react-auth-lambda"
  },"86": {
    "doc": "Getting Started",
    "title": "Configure Credentials",
    "content": ". | Open {workspace}/{vertical}/services_config/nn_env.json. | Set JWT_SECRET to a unique value. | Create an OAuth 2.0 Client ID (Web application) in the Google Cloud Console. | Add GOOGLE_CLIENT_ID and GOOGLE_CLIENT_SECRET to nn_env.json: . { \"JWT_ALGORITHM\": \"HS256\", \"JWT_SECRET\": \"your-unique-secret\", \"GOOGLE_CLIENT_ID\": \"your-client-id.apps.googleusercontent.com\", \"GOOGLE_CLIENT_SECRET\": \"your-client-secret\" } . | . ",
    "url": "/verticals/ral/getting-started.html#configure-credentials",
    
    "relUrl": "/verticals/ral/getting-started.html#configure-credentials"
  },"87": {
    "doc": "Getting Started",
    "title": "Deploy Services",
    "content": ". | In Nar Actions, deploy the Auth service. | Copy the auth service URL from the deploy output. | In Google Cloud Console, add the Authorized redirect URI: . https://&lt;auth-service-url&gt;/oauth/loggedin . | . ",
    "url": "/verticals/ral/getting-started.html#deploy-services",
    
    "relUrl": "/verticals/ral/getting-started.html#deploy-services"
  },"88": {
    "doc": "Getting Started",
    "title": "Deploy UI",
    "content": ". | In Nar Actions, deploy the UI. | Open your site and log in to verify. | . Your React source files are at {workspace}/{vertical}/ui/. See the React UI guide for project structure. ",
    "url": "/verticals/ral/getting-started.html#deploy-ui",
    
    "relUrl": "/verticals/ral/getting-started.html#deploy-ui"
  },"89": {
    "doc": "Getting Started",
    "title": "Related",
    "content": ". | Service Environment Variables — details on nn_env.json | Auth Service Setup — more on Google OAuth configuration | . ",
    "url": "/verticals/ral/getting-started.html#related",
    
    "relUrl": "/verticals/ral/getting-started.html#related"
  },"90": {
    "doc": "Getting Started",
    "title": "Getting Started",
    "content": " ",
    "url": "/verticals/ral/getting-started.html",
    
    "relUrl": "/verticals/ral/getting-started.html"
  },"91": {
    "doc": "Getting Started",
    "title": "Getting Started with Paddle Payment Integration",
    "content": ". ",
    "url": "/verticals/ppay/getting-started.html#getting-started-with-paddle-payment-integration",
    
    "relUrl": "/verticals/ppay/getting-started.html#getting-started-with-paddle-payment-integration"
  },"92": {
    "doc": "Getting Started",
    "title": "Configure Credentials",
    "content": ". | Open {workspace}/{vertical}/services_config/nn_env.json. | Set JWT_SECRET to a unique value. | Create an OAuth 2.0 Client ID (Web application) in the Google Cloud Console. | Add credentials and admin email to nn_env.json: . { \"JWT_ALGORITHM\": \"HS256\", \"JWT_SECRET\": \"your-unique-secret\", \"GOOGLE_CLIENT_ID\": \"your-client-id.apps.googleusercontent.com\", \"GOOGLE_CLIENT_SECRET\": \"your-client-secret\", \"admin_emails\": \"your-email@example.com\" } . | . ",
    "url": "/verticals/ppay/getting-started.html#configure-credentials",
    
    "relUrl": "/verticals/ppay/getting-started.html#configure-credentials"
  },"93": {
    "doc": "Getting Started",
    "title": "Deploy Services",
    "content": ". | In Nar Actions, deploy the Auth service. | In Nar Actions, deploy the Subscription and Billing service. | Copy the auth service URL from the deploy output. | In Google Cloud Console, add the Authorized redirect URI: . https://&lt;auth-service-url&gt;/oauth/loggedin . | . ",
    "url": "/verticals/ppay/getting-started.html#deploy-services",
    
    "relUrl": "/verticals/ppay/getting-started.html#deploy-services"
  },"94": {
    "doc": "Getting Started",
    "title": "Deploy UI and Configure Paddle",
    "content": ". | In Nar Actions, deploy the UI. | Open your site and log in. You should see the Admin link in the nav bar. | Go to Admin &gt; Manage Products &gt; Credentials tab. | Enter your Paddle credentials: . | API Key — from the Paddle dashboard (Developer Tools &gt; Authentication) | Client Token — from Paddle (used for frontend checkout) | Webhook Secret — from Paddle (Developer Tools &gt; Notifications) | . | In Paddle, set the webhook URL to your Subscription and Billing service endpoint: . https://sbcs.us-east-1.{site}.{vertical}.narambu.com/webhook . | Use the Environment dropdown to configure Sandbox or Live separately. | . ",
    "url": "/verticals/ppay/getting-started.html#deploy-ui-and-configure-paddle",
    
    "relUrl": "/verticals/ppay/getting-started.html#deploy-ui-and-configure-paddle"
  },"95": {
    "doc": "Getting Started",
    "title": "Sync Product Catalog",
    "content": ". | Go to the Sync tab and sync your product catalog from Paddle. | Go to the Classify tab to select which products are shown to users. | . ",
    "url": "/verticals/ppay/getting-started.html#sync-product-catalog",
    
    "relUrl": "/verticals/ppay/getting-started.html#sync-product-catalog"
  },"96": {
    "doc": "Getting Started",
    "title": "Related",
    "content": ". | Service Environment Variables — details on nn_env.json | Auth Service Setup — more on Google OAuth configuration | . ",
    "url": "/verticals/ppay/getting-started.html#related",
    
    "relUrl": "/verticals/ppay/getting-started.html#related"
  },"97": {
    "doc": "Getting Started",
    "title": "Getting Started",
    "content": " ",
    "url": "/verticals/ppay/getting-started.html",
    
    "relUrl": "/verticals/ppay/getting-started.html"
  },"98": {
    "doc": "Nar",
    "title": "Nar: Deploy without the complexity",
    "content": "Nar is a deployment tool that ships applications to your own cloud account — without wrestling with cloud consoles or writing complex IaC. Use the visual interface to deploy interactively, or run the CLI to automate deployments in your CI/CD pipelines. ",
    "url": "/#nar-deploy-without-the-complexity",
    
    "relUrl": "/#nar-deploy-without-the-complexity"
  },"99": {
    "doc": "Nar",
    "title": "Philosophy",
    "content": ". | True Ownership — Everything runs in your own cloud account. You own the code, the data, and the infrastructure. | Zero Lock-in — Nar provisions standard cloud resources. There’s no proprietary runtime or abstraction layer. If you stop using Nar, your infrastructure keeps running — and you can import your resources into any IaC tool of your choice and continue from there. | Opinionated by Design — Nar makes deliberate choices about how your application is deployed. That means fewer decisions for you and tested paths that work every time. We’re confident that once you experience the simplicity, you’ll want to stay. | . ",
    "url": "/#philosophy",
    
    "relUrl": "/#philosophy"
  },"100": {
    "doc": "Nar",
    "title": "What Nar Does",
    "content": "| Feature | Description | . | Nar Actions | Visual interface for managing sites, environments, and deployments. | . | CLI | Run nar.sh with --auto-approve for scripted or pipeline-based deployments. | . | Verticals | Ready-to-deploy application stacks — like Google OAuth or Paddle-based subscription billing — that you can select and customize. | . | Infrastructure Management | Provisions and connects the cloud resources your application needs. See Composites for currently supported infrastructure. | . ",
    "url": "/#what-nar-does",
    
    "relUrl": "/#what-nar-does"
  },"101": {
    "doc": "Nar",
    "title": "Quick Start",
    "content": "Quick Start — Deploy a React app with Google OAuth from scratch. ",
    "url": "/#quick-start",
    
    "relUrl": "/#quick-start"
  },"102": {
    "doc": "Nar",
    "title": "Nar",
    "content": " ",
    "url": "/",
    
    "relUrl": "/"
  },"103": {
    "doc": "Context",
    "title": "Context (Init)",
    "content": "Before Nar can create resources in your cloud account, it needs a one-time initialization. ",
    "url": "/nar/nar-actions/init.html#context-init",
    
    "relUrl": "/nar/nar-actions/init.html#context-init"
  },"104": {
    "doc": "Context",
    "title": "What Init Does",
    "content": "Clicking Init performs these steps: . | Creates the state bucket — A storage bucket for deployment state, shared across all verticals in the same account. | Creates a deploy role — A role that Nar assumes to provision infrastructure, created per vertical. | Initializes configurations — Prepares both the Data Layer and App Layer for deployment. | . ",
    "url": "/nar/nar-actions/init.html#what-init-does",
    
    "relUrl": "/nar/nar-actions/init.html#what-init-does"
  },"105": {
    "doc": "Context",
    "title": "When to Run",
    "content": "Run Init once per vertical. You also need to re-run it if you switch accounts or profiles. Answer Y to any terminal prompts during the process. ",
    "url": "/nar/nar-actions/init.html#when-to-run",
    
    "relUrl": "/nar/nar-actions/init.html#when-to-run"
  },"106": {
    "doc": "Context",
    "title": "Context",
    "content": " ",
    "url": "/nar/nar-actions/init.html",
    
    "relUrl": "/nar/nar-actions/init.html"
  },"107": {
    "doc": "Lambda + API Gateway",
    "title": "Lambda + API Gateway",
    "content": "Each backend service becomes a standalone Lambda function behind an API Gateway endpoint. Services are packaged as container images. The default Dockerfile supports Python 3.13. You can customize Dockerfiles. VPC support for Lambda functions is coming soon. ",
    "url": "/nar/composites/aws/lambda-api-gateway.html",
    
    "relUrl": "/nar/composites/aws/lambda-api-gateway.html"
  },"108": {
    "doc": "Lambda + API Gateway",
    "title": "AWS Architecture",
    "content": "Backend services run as AWS Lambda functions fronted by HTTP API Gateway endpoints. Client Request │ ▼ API Gateway (HTTP) │ ▼ Lambda Function (Container Image) │ ├── Reads/writes to S3 └── CloudWatch Logs . How it works: . | Each backend service you define becomes its own Lambda function. | Lambda functions run as container images stored in ECR (Elastic Container Registry). | CodeBuild handles packaging and deploying new versions when you click Deploy Service. | API Gateway provides a public HTTPS endpoint for each service. | If you configure a custom domain, each service gets its own subdomain: . {service}.{region}.{site}.{vertical}.yourdomain.com . | . AWS resources created: . Lambda, API Gateway (HTTP), ECR repository, CodeBuild project, IAM roles, CloudWatch log groups, and optionally Route 53 records + ACM certificates for custom domains. ",
    "url": "/nar/composites/aws/lambda-api-gateway.html#aws-architecture",
    
    "relUrl": "/nar/composites/aws/lambda-api-gateway.html#aws-architecture"
  },"109": {
    "doc": "Lambda + API Gateway",
    "title": "Dockerfile",
    "content": "The default Dockerfile expects Python source code in {service}/src/ and pip dependencies in {service}/scripts/requirements.txt. It supports Python 3.13. To use a different Python version, add system packages, or use a non-Python language, provide a custom Dockerfile. ",
    "url": "/nar/composites/aws/lambda-api-gateway.html#dockerfile",
    
    "relUrl": "/nar/composites/aws/lambda-api-gateway.html#dockerfile"
  },"110": {
    "doc": "Lambda + API Gateway",
    "title": "Environment Variables",
    "content": "See Service Environment Variables. ",
    "url": "/nar/composites/aws/lambda-api-gateway.html#environment-variables",
    
    "relUrl": "/nar/composites/aws/lambda-api-gateway.html#environment-variables"
  },"111": {
    "doc": "Nar Actions",
    "title": "Nar Actions",
    "content": "Nar Actions is the visual interface for managing your deployments. It lets you provision infrastructure, deploy code, and manage multiple environments — all without touching cloud consoles. Every action available in Nar Actions can also be run via the CLI for scripted or pipeline-based workflows. ",
    "url": "/nar/nar-actions.html",
    
    "relUrl": "/nar/nar-actions.html"
  },"112": {
    "doc": "Nar Actions",
    "title": "Workflow",
    "content": "The typical deployment flow through Nar Actions: . | Context (Init) — One-time setup: create a role and state storage in your cloud account. | Sites — Create and switch between environments (dev, staging, prod). | Data Layer — Provision storage buckets. | App Layer — Provision composites and deploy your code. | . ",
    "url": "/nar/nar-actions.html#workflow",
    
    "relUrl": "/nar/nar-actions.html#workflow"
  },"113": {
    "doc": "Nar Actions",
    "title": "Maintenance",
    "content": ". | Fix Paths — Update configuration paths after moving your project folder. | Tools — State recovery, resource listing, CORS configuration. | Vertical — Understand and manage the active vertical. | Destructive Actions — Delete resources and tear down sites. | . ",
    "url": "/nar/nar-actions.html#maintenance",
    
    "relUrl": "/nar/nar-actions.html#maintenance"
  },"114": {
    "doc": "Node.js",
    "title": "Installing Node.js",
    "content": "Nar requires Node.js 20 or later to build frontend assets. ",
    "url": "/prerequisites/node.html#installing-nodejs",
    
    "relUrl": "/prerequisites/node.html#installing-nodejs"
  },"115": {
    "doc": "Node.js",
    "title": "Option 1: Direct Download (Recommended)",
    "content": ". | Go to nodejs.org | Download the LTS version (20.x or later) | Run the installer | . Verify: . node --version . You should see v20.x.x or higher. ",
    "url": "/prerequisites/node.html#option-1-direct-download-recommended",
    
    "relUrl": "/prerequisites/node.html#option-1-direct-download-recommended"
  },"116": {
    "doc": "Node.js",
    "title": "Option 2: nvm (Node Version Manager)",
    "content": "nvm lets you install and switch between multiple Node versions. curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.0/install.sh | bash . Close and reopen your terminal, then: . nvm install 20 nvm use 20 nvm alias default 20 . ",
    "url": "/prerequisites/node.html#option-2-nvm-node-version-manager",
    
    "relUrl": "/prerequisites/node.html#option-2-nvm-node-version-manager"
  },"117": {
    "doc": "Node.js",
    "title": "Option 3: Homebrew (macOS)",
    "content": "brew install node@20 . ",
    "url": "/prerequisites/node.html#option-3-homebrew-macos",
    
    "relUrl": "/prerequisites/node.html#option-3-homebrew-macos"
  },"118": {
    "doc": "Node.js",
    "title": "npm",
    "content": "npm comes bundled with Node.js — no separate install needed. npm --version . ",
    "url": "/prerequisites/node.html#npm",
    
    "relUrl": "/prerequisites/node.html#npm"
  },"119": {
    "doc": "Node.js",
    "title": "Troubleshooting",
    "content": "| Problem | Solution | . | node: command not found | Restart your terminal, or check that Node is in your PATH. | . | Wrong Node version | Use nvm to switch: nvm use 20 | . | Permission errors with npm | Don’t use sudo with npm. Fix with: sudo chown -R $(whoami) ~/.npm | . ",
    "url": "/prerequisites/node.html#troubleshooting",
    
    "relUrl": "/prerequisites/node.html#troubleshooting"
  },"120": {
    "doc": "Node.js",
    "title": "Node.js",
    "content": " ",
    "url": "/prerequisites/node.html",
    
    "relUrl": "/prerequisites/node.html"
  },"121": {
    "doc": "payments",
    "title": "payments",
    "content": "Used by the Paddle Payment Integration vertical. Provides billing pages and Paddle API client for subscriptions and one-time purchases. ",
    "url": "/verticals/common/uipackages/payments.html",
    
    "relUrl": "/verticals/common/uipackages/payments.html"
  },"122": {
    "doc": "payments",
    "title": "Project Structure",
    "content": "Resolved via the nnet-payments alias in {workspace}/{vertical}/ui/vite.config.ts. payments/ ├── pages/Payment/ │ ├── Admin.tsx # Admin dashboard │ └── Paddle/ │ ├── Billing.tsx # Subscription, purchase, and billing management │ ├── Invoices.tsx # Invoice history │ ├── Entities.tsx # Entity/customer management │ └── AdminProducts.tsx # Product and pricing configuration ├── services/ │ ├── sbcs_paddle/ # SBCS API client │ │ ├── products.ts # Product queries │ │ ├── subscriptions.ts # Subscription operations │ │ ├── billing.ts # Billing history │ │ ├── entities.ts # Entity management │ │ ├── config.ts # Credentials and product config │ │ └── admin.ts # Admin operations │ ├── sbcs_config.ts # Active provider config, admin check │ └── paddle/ │ └── paddleService.ts # Paddle SDK integration └── components/ └── Notice.tsx # Alert/notification component . ",
    "url": "/verticals/common/uipackages/payments.html#project-structure",
    
    "relUrl": "/verticals/common/uipackages/payments.html#project-structure"
  },"123": {
    "doc": "Paddle Payment Integration",
    "title": "Paddle Payment Integration",
    "content": "A complete payment integration vertical using Paddle for subscriptions, one-time purchases, and license management. Getting Started — Configure auth, Paddle keys, and admin access. Includes: . | Payments UI — React frontend for checkout, billing, subscriptions, and admin. | Subscription and Billing Service — Backend Lambda for Paddle webhook processing, license logic, and customer management. | Auth Service — Shared Google OAuth authentication. | . FAQ: . | I edited the price in Paddle but do not see it reflected in users billing options | How do I log in as admin? | . ",
    "url": "/verticals/ppay.html",
    
    "relUrl": "/verticals/ppay.html"
  },"124": {
    "doc": "Paddle Payment Integration",
    "title": "Paddle Payment Integration",
    "content": " ",
    "url": "/nar/faq/vertical-configuration/ppay.html",
    
    "relUrl": "/nar/faq/vertical-configuration/ppay.html"
  },"125": {
    "doc": "Paddle Payment Integration",
    "title": "I edited the price in Paddle but do not see it reflected in users billing options",
    "content": "When you update a price directly in the Paddle dashboard, the change is not automatically picked up by your deployed application. The billing options shown to users are based on the product configuration saved in your admin panel, not fetched live from Paddle on every page load. How to fix . | Log in as an admin user (see How do I log in as admin? below). | Navigate to the Admin page. | Go to the Classify section — this shows the products and prices pulled from your Paddle catalog. | Save the products again. This re-syncs the product configuration with the latest Paddle pricing. | . After saving, the updated prices will appear in the billing options for your users. ",
    "url": "/nar/faq/vertical-configuration/ppay.html#i-edited-the-price-in-paddle-but-do-not-see-it-reflected-in-users-billing-options",
    
    "relUrl": "/nar/faq/vertical-configuration/ppay.html#i-edited-the-price-in-paddle-but-do-not-see-it-reflected-in-users-billing-options"
  },"126": {
    "doc": "Paddle Payment Integration",
    "title": "How do I log in as admin?",
    "content": "Admin access is controlled by the nn_env.json configuration file in your service config. Only email addresses listed in that file are granted admin privileges. Steps . | Open your service configuration file at {vertical}/services_config/nn_env.json. | Add your email address to the admin_emails list: { \"admin_emails\": [\"your-email@example.com\"] } . | Redeploy the service — select Subscription and Billing from the Service dropdown in Nar Actions and click Deploy Service. | Log in to your application using the email address you added. | . Once logged in with an admin email, the Admin link will appear in the navigation bar. ",
    "url": "/nar/faq/vertical-configuration/ppay.html#how-do-i-log-in-as-admin",
    
    "relUrl": "/nar/faq/vertical-configuration/ppay.html#how-do-i-log-in-as-admin"
  },"127": {
    "doc": "Prerequisites",
    "title": "Prerequisites",
    "content": "Before using Nar, you need: . | Node.js 20 — Required for building your frontend UI. | AWS Credentials — So Nar can deploy resources to your AWS account. | . ",
    "url": "/prerequisites.html",
    
    "relUrl": "/prerequisites.html"
  },"128": {
    "doc": "Quick Start",
    "title": "Quick Start",
    "content": "Deploy a React application with Google OAuth to your AWS account. Prerequisite: Node.js 20 + AWS credentials . | Open the Nar app. | Click Open and select an empty folder. This becomes your workspace. | In the Vertical dropdown, select React Auth Lambda. | Expand Context and click Init. Answer Y to prompts. | Confirm dev appears in the Site dropdown. | Expand Data Layer and click Setup. Answer Y to prompts. | Expand App Layer and click Setup. Answer Y to prompts. | Open the URL from the terminal output. Your React app is live. | . ",
    "url": "/nar/quickstart.html",
    
    "relUrl": "/nar/quickstart.html"
  },"129": {
    "doc": "Quick Start",
    "title": "Next Steps",
    "content": ". | Configure OAuth — Follow the React Auth Lambda Getting Started guide to set up Google login. | Custom Domain — Edit {workspace}/{vertical}/nnet/domain.json. | Apex Domain — Configure {workspace}/{vertical}/nnet/apex.json. | Deploy Changes — After editing code, click Deploy UI in Nar Actions. | . ",
    "url": "/nar/quickstart.html#next-steps",
    
    "relUrl": "/nar/quickstart.html#next-steps"
  },"130": {
    "doc": "React Auth Lambda",
    "title": "React Auth Lambda",
    "content": "A React + Vite starter with Google OAuth authentication, deployed as a Lambda service. This vertical comes bundled with Nar App — no separate download needed. Getting Started — Configure auth and deploy. Includes: . | React UI — Frontend built with React 19, Vite, and Tailwind CSS. | Auth Service — Python Lambda that handles Google OAuth login and session management. | . ",
    "url": "/verticals/ral.html",
    
    "relUrl": "/verticals/ral.html"
  },"131": {
    "doc": "Subscription and Billing Service",
    "title": "Subscription and Billing Service",
    "content": "The Subscription and Billing Service is a Python Lambda that integrates with the Paddle payment gateway. It handles the backend logic for the Paddle Payment Integration vertical. ",
    "url": "/verticals/ppay/sbcs.html",
    
    "relUrl": "/verticals/ppay/sbcs.html"
  },"132": {
    "doc": "Subscription and Billing Service",
    "title": "What It Does",
    "content": ". | Webhook Processing — Receives Paddle webhooks and syncs billing data to S3. | Subscription Management — APIs for checking status, cancelling, resuming, and switching plans. | One-Time Purchases — Tracks completed purchases, handles refunds, and grants product access. | Entity Licenses — Allocates named seats or slots per purchase/subscription. Each product price can grant a configurable number of entities. Entities are automatically cleaned up if a subscription lapses or a purchase is refunded. | Billing History — Provides invoice and transaction data to the frontend. | . ",
    "url": "/verticals/ppay/sbcs.html#what-it-does",
    
    "relUrl": "/verticals/ppay/sbcs.html#what-it-does"
  },"133": {
    "doc": "Subscription and Billing Service",
    "title": "API Endpoints",
    "content": "User Routes . | Method | Path | Description | . | GET | /subscriptions/status | Get subscription status by product | . | POST | /subscriptions/cancel | Schedule cancellation at period end | . | POST | /subscriptions/resume | Resume canceled subscription | . | POST | /subscriptions/update | Switch to a different plan | . | GET | /billing/history | Get past transactions | . | GET | /billing/invoice | Download invoice PDF | . | GET | /products/list | List products and pricing | . | GET | /products/access | Check product access (subscriptions and one-time purchases) | . | POST | /licenses/save | Create entity license | . | POST | /licenses/update | Update entity license | . | GET | /licenses/list | List entity licenses | . | GET | /licenses/check | Verify license validity | . | GET | /sync/status | Check if billing sync is complete | . | POST | /sync/force | Force immediate billing data sync | . Admin Routes . Admin routes require the provider path prefix: /paddle/{sandbox|live}. | Method | Path | Description | . | POST | /admin/sync | Sync customer data from Paddle | . | GET | /admin/catalog | List Paddle product catalog | . | GET | /config/products | Get product configuration | . | POST | /config/products | Save product configuration | . | GET | /config/p_ref | Get product reference names | . | POST | /config/p_ref | Save product reference names | . | GET | /config/credentials | Get Paddle API credentials (masked) | . | POST | /config/credentials | Update Paddle webhook secret | . Webhook . | Method | Path | Description | . | POST | /webhook | Process Paddle webhook events | . Config . | Method | Path | Description | . | GET | /config/active | Get active payment provider | . | POST | /config/active | Set active payment provider | . | GET | /config/providers | List available providers | . | GET | /config/is-admin | Check if current user is admin | . Device . | Method | Path | Description | . | POST | /uuid | Register device UUID | . | GET | /uuid/{uuid} | Get device UUID status | . ",
    "url": "/verticals/ppay/sbcs.html#api-endpoints",
    
    "relUrl": "/verticals/ppay/sbcs.html#api-endpoints"
  },"134": {
    "doc": "Subscription and Billing Service",
    "title": "Project Structure",
    "content": "Location: {vertical}/sbcs/ . sbcs/src/ ├── lambda_handler.py # Entry point + routing └── lfn/ ├── common/ # Provider config, admin check, S3 config ├── device/ # UUID registration and tracking ├── paddle/ │ ├── api_client.py # Paddle HTTP client with retry logic │ ├── admin/ # Catalog and product config │ └── user/ │ ├── record/ # Sync engine, webhook handler │ ├── status/ # Subscriptions, purchases, history │ ├── operations/ # Cancel, resume, switch │ └── license/ # Product access, entity licenses └── stripe/ # Stripe provider (stub) . ",
    "url": "/verticals/ppay/sbcs.html#project-structure",
    
    "relUrl": "/verticals/ppay/sbcs.html#project-structure"
  },"135": {
    "doc": "Subscription and Billing Service",
    "title": "Configuration",
    "content": "This service requires Paddle API credentials. You can configure them in two ways: . | Via the Admin panel at /admin | Directly in your environment settings | . The service works alongside the Auth Service — all user routes require authentication. ",
    "url": "/verticals/ppay/sbcs.html#configuration",
    
    "relUrl": "/verticals/ppay/sbcs.html#configuration"
  },"136": {
    "doc": "Subscription and Billing Service",
    "title": "Redeployment",
    "content": "After updating the billing logic: . | Select Subscription and Billing from the Service dropdown in Nar Actions. | Click Deploy Service. | . ",
    "url": "/verticals/ppay/sbcs.html#redeployment",
    
    "relUrl": "/verticals/ppay/sbcs.html#redeployment"
  },"137": {
    "doc": "services.lambda",
    "title": "services.lambda",
    "content": "Defines serverless backend services. Each entry becomes an independently deployable function with its own API endpoint. By default, deploys to the Lambda + API Gateway composite. ",
    "url": "/nar/workspace/code-json/services-lambda.html",
    
    "relUrl": "/nar/workspace/code-json/services-lambda.html"
  },"138": {
    "doc": "services.lambda",
    "title": "Configuration",
    "content": "{ \"services\": { \"lambda\": [ { \"name\": \"auth\", \"location\": \"orig/auth\" }, { \"name\": \"sbcs\", \"location\": \"orig/sbcs\" } ] } } . | Field | Description | . | name | Service identifier (e.g., auth, sbcs). Used in resource naming, Deploy Service dropdown, and URL generation. | . | location | Path to the service source code, relative to the vertical folder. | . | dockerfile | (Optional) Path to a custom Dockerfile. Defaults to Nar’s built-in Dockerfile. | . ",
    "url": "/nar/workspace/code-json/services-lambda.html#configuration",
    
    "relUrl": "/nar/workspace/code-json/services-lambda.html#configuration"
  },"139": {
    "doc": "services.lambda",
    "title": "Shared Libraries",
    "content": "The sharedLibs array defines libraries that get bundled with every service during deployment. { \"services\": { \"sharedLibs\": [ { \"name\": \"common\", \"location\": \"orig/common\" } ] } } . Each shared library is copied into the deployment package alongside the service code. ",
    "url": "/nar/workspace/code-json/services-lambda.html#shared-libraries",
    
    "relUrl": "/nar/workspace/code-json/services-lambda.html#shared-libraries"
  },"140": {
    "doc": "services.lambda",
    "title": "Config Directory",
    "content": "The configDir specifies where global service configuration lives: . { \"services\": { \"configDir\": { \"name\": \"services_config\", \"location\": \"orig/services_config\" } } } . This directory contains nn_env.json for environment variables shared across all services. ",
    "url": "/nar/workspace/code-json/services-lambda.html#config-directory",
    
    "relUrl": "/nar/workspace/code-json/services-lambda.html#config-directory"
  },"141": {
    "doc": "site/*.json",
    "title": "site/*.json",
    "content": "Each file in the {vertical}/nnet/site/ directory represents a deployable site and region combination. Location: {vertical}/nnet/site/{site}_{region}.json . ",
    "url": "/nar/workspace/site-json.html",
    
    "relUrl": "/nar/workspace/site-json.html"
  },"142": {
    "doc": "site/*.json",
    "title": "Example",
    "content": "A vertical with two sites: . {vertical}/nnet/ └── site/ ├── dev_us-east-1.json └── prod_us-east-1.json . ",
    "url": "/nar/workspace/site-json.html#example",
    
    "relUrl": "/nar/workspace/site-json.html#example"
  },"143": {
    "doc": "site/*.json",
    "title": "File Contents",
    "content": "Site files are empty JSON objects: . {} . The site name and region are derived from the filename — the file contents are not used. ",
    "url": "/nar/workspace/site-json.html#file-contents",
    
    "relUrl": "/nar/workspace/site-json.html#file-contents"
  },"144": {
    "doc": "site/*.json",
    "title": "Naming Format",
    "content": "{site}_{region}.json . | Part | Description | Examples | . | site | Environment name | dev, staging, prod | . | region | AWS region | us-east-1, eu-west-1 | . ",
    "url": "/nar/workspace/site-json.html#naming-format",
    
    "relUrl": "/nar/workspace/site-json.html#naming-format"
  },"145": {
    "doc": "site/*.json",
    "title": "Creating Sites",
    "content": "You can create sites either by: . | Clicking the + (Plus) icon in the Nar Actions Sites section. | Manually creating an empty JSON file in {vertical}/nnet/site/ with the correct naming format. | . ",
    "url": "/nar/workspace/site-json.html#creating-sites",
    
    "relUrl": "/nar/workspace/site-json.html#creating-sites"
  },"146": {
    "doc": "Sites",
    "title": "Sites",
    "content": "A Site is an isolated deployment of your application — typically representing an environment like dev, staging, or prod. ",
    "url": "/nar/nar-actions/sites.html",
    
    "relUrl": "/nar/nar-actions/sites.html"
  },"147": {
    "doc": "Sites",
    "title": "Creating a Site",
    "content": "Click the + (Plus) icon, provide a name (e.g., staging) and select a region (e.g., us-east-1). This creates a site configuration file at {vertical}/nnet/site/{name}_{region}.json. ",
    "url": "/nar/nar-actions/sites.html#creating-a-site",
    
    "relUrl": "/nar/nar-actions/sites.html#creating-a-site"
  },"148": {
    "doc": "Sites",
    "title": "Switching Between Sites",
    "content": "Use the dropdown to select the active site. All actions in Nar Actions — Setup, Deploy, Delete — apply only to the currently selected site. ",
    "url": "/nar/nar-actions/sites.html#switching-between-sites",
    
    "relUrl": "/nar/nar-actions/sites.html#switching-between-sites"
  },"149": {
    "doc": "Sites",
    "title": "How Sites Are Isolated",
    "content": "Each site gets its own independent set of resources — separate storage, separate services, separate CDN. This means you can deploy and test in dev without affecting prod. ",
    "url": "/nar/nar-actions/sites.html#how-sites-are-isolated",
    
    "relUrl": "/nar/nar-actions/sites.html#how-sites-are-isolated"
  },"150": {
    "doc": "Structure",
    "title": "Workspace Structure",
    "content": "A Nar workspace can contain multiple verticals, each in its own sub-folder. {workspace}/ ├── ral/ # React Auth Lambda vertical │ ├── auth/ # Auth service source code │ ├── common/ # Shared Python libraries │ ├── services_config/ # Service environment variables (nn_env.json) │ ├── ui/ # React + Vite frontend source │ ├── ui_config/ # UI environment variables (nn_env.json) │ ├── nnet/ # Your configuration (preserved across updates) │ │ ├── code.json │ │ ├── domain.json │ │ ├── apex.json │ │ ├── awsprofile.json │ │ ├── cors.json │ │ ├── byv/ │ │ └── site/ │ └── backup/ # Timestamped backups before updates └── ppay/ # Paddle Payment Integration vertical ├── auth/ ├── common/ ├── sbcs/ ├── services_config/ ├── ui/ ├── ui_config/ └── nnet/ . Use the directory names shown above (e.g., {workspace}/{vertical}/auth/, {workspace}/{vertical}/ui/) when navigating your code. ",
    "url": "/nar/workspace/structure.html#workspace-structure",
    
    "relUrl": "/nar/workspace/structure.html#workspace-structure"
  },"151": {
    "doc": "Structure",
    "title": "Key Directories",
    "content": "| Directory | Purpose | . | nnet/ | Your configuration — tells Nar what to deploy and how. Preserved across updates. | . | services_config/ | Global service environment variables (nn_env.json). | . | ui_config/ | UI environment variables (nn_env.json). | . ",
    "url": "/nar/workspace/structure.html#key-directories",
    
    "relUrl": "/nar/workspace/structure.html#key-directories"
  },"152": {
    "doc": "Structure",
    "title": "Structure",
    "content": " ",
    "url": "/nar/workspace/structure.html",
    
    "relUrl": "/nar/workspace/structure.html"
  },"153": {
    "doc": "Tools",
    "title": "Tools",
    "content": "Utilities for inspecting and maintaining your deployed infrastructure. ",
    "url": "/nar/nar-actions/tools.html",
    
    "relUrl": "/nar/nar-actions/tools.html"
  },"154": {
    "doc": "Tools",
    "title": "State Recovery",
    "content": "Recover . Recover re-syncs your local state with what actually exists in AWS. It does not create, modify, or delete anything in your AWS account — it only reads from AWS and imports resources into your local state file. If something feels off after a deployment — errors about resources already existing, Route53 records out of sync, or state that doesn’t match what you see in the AWS console — click Recover as a first step. It’s safe to run at any time and is the recommended first resort before investigating further. When to use it . A common example is Route53 inconsistency: DNS records exist in AWS but your local state doesn’t know about them, so the next deployment fails trying to create records that are already there. Recover finds those records in AWS and imports them, resolving the conflict without any manual cleanup. More generally, use Recover whenever a deployment was interrupted, your state file is out of sync, or you simply want to make sure your local view matches reality. What it does . | Refreshes terraform configuration from a clean copy in the extension bundle. | Initializes the state backend (same as Init). | Discovers resources in AWS using naming patterns derived from your site configuration. | Generates Terraform import blocks for each discovered resource. | Applies the imports to bring your local state in sync. | . Safety measures . | Purely additive — Recover uses Terraform’s native import mechanism. It adds resources to your state file. There is no deletion code involved. | AWS is untouched — Nothing in your AWS account is created, modified, or removed. Recover only reads. | DNS record filtering — Only safe record types (A, CNAME) are imported. MX, NS, SOA, TXT, SRV, and SPF records are explicitly blocked to protect your email and DNS infrastructure. | Existence validation — Each resource is looked up in AWS before importing. If a resource doesn’t exist, it’s skipped. | Clean config — Terraform files are refreshed from the extension bundle before running, so stale local modifications can’t interfere. | . Recover vs Nuke . Recover and Nuke are opposites. Recover imports what exists in AWS into your local state — nothing in AWS changes. Nuke destroys resources in AWS permanently. Recover is safe to run anytime; Nuke is a last resort. State List . Displays a list of every AWS resource Nar is currently tracking for the selected site. Useful for auditing exactly what’s been provisioned. ",
    "url": "/nar/nar-actions/tools.html#state-recovery",
    
    "relUrl": "/nar/nar-actions/tools.html#state-recovery"
  },"155": {
    "doc": "Tools",
    "title": "Storage",
    "content": "List Buckets . Lists all S3 buckets associated with the selected site and verifies they exist in AWS. ",
    "url": "/nar/nar-actions/tools.html#storage",
    
    "relUrl": "/nar/nar-actions/tools.html#storage"
  },"156": {
    "doc": "Tools",
    "title": "CORS",
    "content": "Enable / Disable CORS . Configures Cross-Origin Resource Sharing (CORS) headers on your S3 storage buckets. If your frontend is getting CORS errors when accessing files from a bucket: . | Select the bucket prefix. | Click Enable. | . Nar sets the appropriate CORS policy on the bucket so your application can access its contents from the browser. You can also configure additional CORS origins per bucket via cors.json. ",
    "url": "/nar/nar-actions/tools.html#cors",
    
    "relUrl": "/nar/nar-actions/tools.html#cors"
  },"157": {
    "doc": "ui.vite",
    "title": "ui.vite",
    "content": "Defines a Vite-built frontend application. By default, deploys to the CloudFront + S3 composite. ",
    "url": "/nar/workspace/code-json/ui-vite.html",
    
    "relUrl": "/nar/workspace/code-json/ui-vite.html"
  },"158": {
    "doc": "ui.vite",
    "title": "Configuration",
    "content": "{ \"ui\": { \"vite\": { \"name\": \"ui\", \"location\": \"orig/ui\" } } } . | Field | Description | . | name | UI identifier. Used in resource naming. | . | location | Path to the Vite project root (must contain package.json). | . ",
    "url": "/nar/workspace/code-json/ui-vite.html#configuration",
    
    "relUrl": "/nar/workspace/code-json/ui-vite.html#configuration"
  },"159": {
    "doc": "ui.vite",
    "title": "Common UI Libraries",
    "content": "The common field defines shared UI code bundled with the main UI: . { \"ui\": { \"common\": { \"name\": \"uicommon\", \"location\": \"orig/uicommon\" } } } . ",
    "url": "/nar/workspace/code-json/ui-vite.html#common-ui-libraries",
    
    "relUrl": "/nar/workspace/code-json/ui-vite.html#common-ui-libraries"
  },"160": {
    "doc": "ui.vite",
    "title": "Config Directory",
    "content": "The configDir specifies where UI configuration lives: . { \"ui\": { \"configDir\": { \"name\": \"ui_config\", \"location\": \"orig/ui_config\" } } } . This directory contains nn_env.json for UI environment variables. ",
    "url": "/nar/workspace/code-json/ui-vite.html#config-directory",
    
    "relUrl": "/nar/workspace/code-json/ui-vite.html#config-directory"
  },"161": {
    "doc": "React UI",
    "title": "React UI",
    "content": "The React Auth Lambda vertical includes a frontend built with React 19 and Vite, served globally via CloudFront. nar.narambu.com is built using Nar itself, and some of the code packaged in this vertical is also used by that website — you can check out the authentication flow there. ",
    "url": "/verticals/ral/ui.html",
    
    "relUrl": "/verticals/ral/ui.html"
  },"162": {
    "doc": "React UI",
    "title": "Stack",
    "content": ". | React 19, Vite, TypeScript | Tailwind CSS, MUI | UI Auth pages from uicommon | . ",
    "url": "/verticals/ral/ui.html#stack",
    
    "relUrl": "/verticals/ral/ui.html#stack"
  },"163": {
    "doc": "React UI",
    "title": "Project Structure",
    "content": "Location: {vertical}/ui/ . ui/src/ ├── App.tsx # Router: /, /versions ├── index.tsx # React entry point ├── components/ │ ├── NavBar.tsx # Navigation bar with login/logout │ └── Footer.tsx # Page footer └── pages/ ├── Home.tsx # Landing page └── Versions.tsx # Version info . ",
    "url": "/verticals/ral/ui.html#project-structure",
    
    "relUrl": "/verticals/ral/ui.html#project-structure"
  },"164": {
    "doc": "React UI",
    "title": "Shared Packages",
    "content": "This vertical imports uicommon for authentication and utilities. The alias is configured in vite.config.ts: . resolve: { alias: { 'nnet-uicommon': path.resolve(__dirname, '../../../uipackages/uicommon'), }, } . Components used from uicommon: . | AuthProvider, useAuth — authentication state management | useTheme — dark mode support | . ",
    "url": "/verticals/ral/ui.html#shared-packages",
    
    "relUrl": "/verticals/ral/ui.html#shared-packages"
  },"165": {
    "doc": "React UI",
    "title": "Customization",
    "content": "The code lives at {workspace}/{vertical}/ui/. Edit the source files to build your application on top of the auth scaffold. ",
    "url": "/verticals/ral/ui.html#customization",
    
    "relUrl": "/verticals/ral/ui.html#customization"
  },"166": {
    "doc": "React UI",
    "title": "Redeployment",
    "content": "After making changes: . | Click Deploy UI in Nar Actions. | Nar builds the Vite project, uploads assets to S3, and invalidates the CloudFront cache. | . ",
    "url": "/verticals/ral/ui.html#redeployment",
    
    "relUrl": "/verticals/ral/ui.html#redeployment"
  },"167": {
    "doc": "Payments UI",
    "title": "Payments UI",
    "content": "The Paddle Payment Integration vertical includes a React frontend for managing subscriptions, checkout flows, and billing. nar.narambu.com is built using Nar itself, and some of the code packaged in this vertical is also used by that website — you can check out the authentication and payments flow there. ",
    "url": "/verticals/ppay/ui.html",
    
    "relUrl": "/verticals/ppay/ui.html"
  },"168": {
    "doc": "Payments UI",
    "title": "Stack",
    "content": ". | React 19, Vite, TypeScript | Tailwind CSS, MUI | UI Auth pages from uicommon | UI Payment pages from payments package | . ",
    "url": "/verticals/ppay/ui.html#stack",
    
    "relUrl": "/verticals/ppay/ui.html#stack"
  },"169": {
    "doc": "Payments UI",
    "title": "Project Structure",
    "content": "Location: {vertical}/ui/ . ui/src/ ├── App.tsx # Router with protected routes ├── index.tsx # React entry point ├── components/ │ ├── NavBar.tsx # Navigation with auth + admin check │ ├── Footer.tsx # Page footer │ └── Notice.tsx # Alert/notification component └── pages/ └── Home.tsx # Landing page . Most pages come from the shared payments package. ",
    "url": "/verticals/ppay/ui.html#project-structure",
    
    "relUrl": "/verticals/ppay/ui.html#project-structure"
  },"170": {
    "doc": "Payments UI",
    "title": "Routes",
    "content": "| Path | Page | Auth Required | Source | . | / | Home | No | Local | . | /billing | Billing | Yes | nnet-payments | . | /invoices | Invoices | Yes | nnet-payments | . | /entities | Entities | Yes | nnet-payments | . | /admin | Admin | Yes | nnet-payments | . | /paddle/:env/admin/products | Product Config | Yes | nnet-payments | . | /token_for_login | Token Login | Yes | nnet-payments | . ",
    "url": "/verticals/ppay/ui.html#routes",
    
    "relUrl": "/verticals/ppay/ui.html#routes"
  },"171": {
    "doc": "Payments UI",
    "title": "Shared Packages",
    "content": "This vertical imports both uicommon and payments. The aliases are configured in vite.config.ts: . resolve: { alias: { 'nnet-uicommon': path.resolve(__dirname, '../../../uipackages/uicommon'), 'nnet-payments': path.resolve(__dirname, '../../../uipackages/payments'), }, } . ",
    "url": "/verticals/ppay/ui.html#shared-packages",
    
    "relUrl": "/verticals/ppay/ui.html#shared-packages"
  },"172": {
    "doc": "Payments UI",
    "title": "Redeployment",
    "content": "After making changes: . | Click Deploy UI in Nar Actions. | Nar builds the Vite project, uploads assets to S3, and invalidates the CloudFront cache. | . ",
    "url": "/verticals/ppay/ui.html#redeployment",
    
    "relUrl": "/verticals/ppay/ui.html#redeployment"
  },"173": {
    "doc": "uicommon",
    "title": "uicommon",
    "content": "Used by all verticals. Provides authentication, HTTP utilities, and theming. ",
    "url": "/verticals/common/uipackages/uicommon.html",
    
    "relUrl": "/verticals/common/uipackages/uicommon.html"
  },"174": {
    "doc": "uicommon",
    "title": "Project Structure",
    "content": "Resolved via the nnet-uicommon alias in {workspace}/{vertical}/ui/vite.config.ts. uicommon/ ├── auth/ │ ├── auth.tsx # AuthProvider, useAuth, ProtectedRoute, LoginButton │ └── logout.tsx # performLogout ├── config/ │ └── runtimeConfig.ts # getRuntimeConfig, useRuntimeConfig ├── services/ │ └── auth_api.ts # get_session, logout (calls Auth Service) └── utils/ ├── ffb_api.ts # fetchJson, postJson, uploadToS3 ├── ffb_cache.ts # Client-side caching with TTL ├── result.ts # Result&lt;T&gt; response type └── useTheme.ts # Dark mode hook . ",
    "url": "/verticals/common/uipackages/uicommon.html#project-structure",
    
    "relUrl": "/verticals/common/uipackages/uicommon.html#project-structure"
  },"175": {
    "doc": "uicommon",
    "title": "Key Exports",
    "content": "| Module | Exports | Description | . | auth/auth | AuthProvider, useAuth, ProtectedRoute, LoginButton | Authentication state and route protection | . | utils/useTheme | useTheme | Dark/light mode based on system preference | . | utils/ffb_api | fetchJson, postJson, uploadToS3 | HTTP client with built-in caching | . | services/auth_api | get_session, logout | Calls the Auth Service | . ",
    "url": "/verticals/common/uipackages/uicommon.html#key-exports",
    
    "relUrl": "/verticals/common/uipackages/uicommon.html#key-exports"
  },"176": {
    "doc": "UI Packages",
    "title": "UI Packages",
    "content": "Shared React packages imported by verticals via vite.config.ts path aliases. The same source code is duplicated to all verticals provided by Nar. | uicommon — Authentication, HTTP utilities, and theming. Used by all verticals. | payments — Billing pages and Paddle API client. Used by Paddle Payment Integration. | . ",
    "url": "/verticals/common/uipackages.html",
    
    "relUrl": "/verticals/common/uipackages.html"
  },"177": {
    "doc": "UI Packages",
    "title": "How Verticals Import Packages",
    "content": "Each vertical configures path aliases in vite.config.ts: . React Auth Lambda — imports uicommon only: . resolve: { alias: { 'nnet-uicommon': path.resolve(__dirname, '../../../uipackages/uicommon'), }, } . Paddle Payment Integration — imports uicommon + payments: . resolve: { alias: { 'nnet-uicommon': path.resolve(__dirname, '../../../uipackages/uicommon'), 'nnet-payments': path.resolve(__dirname, '../../../uipackages/payments'), }, } . Then import in code: . import { AuthProvider } from 'nnet-uicommon/auth/auth'; import PaddleBilling from 'nnet-payments/pages/Payment/Paddle/Billing'; . A custom Vite plugin (resolvePackageDeps) ensures that npm dependencies imported by these packages resolve from the vertical’s own node_modules. ",
    "url": "/verticals/common/uipackages.html#how-verticals-import-packages",
    
    "relUrl": "/verticals/common/uipackages.html#how-verticals-import-packages"
  },"178": {
    "doc": "Vertical Configuration",
    "title": "Vertical Configuration",
    "content": "Commonly asked questions about verticals and their configurations. ",
    "url": "/nar/faq/vertical-configuration.html",
    
    "relUrl": "/nar/faq/vertical-configuration.html"
  },"179": {
    "doc": "Vertical",
    "title": "Verticals",
    "content": "A Vertical is a packaged application stack — code, configuration, and infrastructure definitions — distributed as a .nar file (a zip archive). ",
    "url": "/nar/nar-actions/vertical.html#verticals",
    
    "relUrl": "/nar/nar-actions/vertical.html#verticals"
  },"180": {
    "doc": "Vertical",
    "title": "Example: React Auth Lambda",
    "content": "Selecting this vertical gives you: . | A React + Vite frontend with Google OAuth integration. | A Python Lambda auth service handling OAuth login, session management, and token validation. | Pre-configured nnet/ files that wire everything together. | . ",
    "url": "/nar/nar-actions/vertical.html#example-react-auth-lambda",
    
    "relUrl": "/nar/nar-actions/vertical.html#example-react-auth-lambda"
  },"181": {
    "doc": "Vertical",
    "title": "Example: Paddle Payment Integration",
    "content": "A more complete vertical with: . | A React + Vite frontend for subscriptions, checkout, billing history, and admin management. | A Subscription and Billing Service Lambda that processes Paddle webhooks, manages licenses, and handles payment logic. | A shared auth service for user authentication. | . ",
    "url": "/nar/nar-actions/vertical.html#example-paddle-payment-integration",
    
    "relUrl": "/nar/nar-actions/vertical.html#example-paddle-payment-integration"
  },"182": {
    "doc": "Vertical",
    "title": "Selecting and Importing",
    "content": ". | Select: Choose a vertical from the dropdown. If it’s your first time using this vertical in this workspace, Nar unpacks the code into your project folder. | Import: Click the + button to import a .nar package file into your vertical library. | . ",
    "url": "/nar/nar-actions/vertical.html#selecting-and-importing",
    
    "relUrl": "/nar/nar-actions/vertical.html#selecting-and-importing"
  },"183": {
    "doc": "Vertical",
    "title": "Vertical",
    "content": " ",
    "url": "/nar/nar-actions/vertical.html",
    
    "relUrl": "/nar/nar-actions/vertical.html"
  },"184": {
    "doc": "Verticals",
    "title": "Verticals",
    "content": "A vertical is a complete application stack — frontend, backend services, and configuration — packaged for deployment via Nar. ",
    "url": "/nar/verticals.html",
    
    "relUrl": "/nar/verticals.html"
  },"185": {
    "doc": "Verticals",
    "title": "Managing Verticals",
    "content": ". | Select — Choose a vertical from the dropdown to switch your workspace to it. On first selection, Nar unpacks the source code into your project folder. | Import — Click the + button to add a new vertical from a .nar package file. | . You can have multiple verticals installed and switch between them at any time. ",
    "url": "/nar/verticals.html#managing-verticals",
    
    "relUrl": "/nar/verticals.html#managing-verticals"
  },"186": {
    "doc": "Verticals",
    "title": "Available Verticals",
    "content": "| Vertical | What it includes | . | React Auth Lambda | React + Vite UI with Google OAuth via Lambda. Bundled with Nar. | . | Paddle Payment Integration | Subscription billing, license management, and admin dashboard using Paddle. | . Both verticals share a common Auth Service for Google OAuth. ",
    "url": "/nar/verticals.html#available-verticals",
    
    "relUrl": "/nar/verticals.html#available-verticals"
  },"187": {
    "doc": "Workspace",
    "title": "Workspace",
    "content": "Your workspace is the local folder where Nar manages your project code and configuration. Each sub-folder in the workspace represents a vertical. ",
    "url": "/nar/workspace.html",
    
    "relUrl": "/nar/workspace.html"
  },"188": {
    "doc": "Workspace",
    "title": "Choosing Workspace",
    "content": "When you first launch Nar, you’ll be prompted to select a workspace folder. This is where your vertical projects and their nnet/ configuration directories will live. ",
    "url": "/nar/workspace.html#choosing-workspace",
    
    "relUrl": "/nar/workspace.html#choosing-workspace"
  },"189": {
    "doc": "Workspace",
    "title": "Key Directories",
    "content": ". | Structure — How the workspace is organized. | nnet/ Configuration — The configuration directory inside each vertical that controls what gets deployed and how. | . ",
    "url": "/nar/workspace.html#key-directories",
    
    "relUrl": "/nar/workspace.html#key-directories"
  },"190": {
    "doc": "Workspace",
    "title": "Configuration Reference",
    "content": "| File | What it controls | . | code.json | Which services and UI to deploy, and where the source code lives. | . | domain.json | Custom domain name for your deployment. | . | apex.json | Root domain routing to a specific site. | . ",
    "url": "/nar/workspace.html#configuration-reference",
    
    "relUrl": "/nar/workspace.html#configuration-reference"
  }
}
